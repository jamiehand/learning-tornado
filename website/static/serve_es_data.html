<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- meta: needed to ensure that the browser can
        parse D3â€™s functions and data properly -->
        <meta charset="utf-8">
        <title>Static File</title>
        <!-- this script tag: locates d3 in d3 directory -->
        <script type="text/javascript" src="d3/d3.v3.js"></script>
        <style type="text/css">
            text {
                font-family: sans-serif;
                font-size: 12px;
                fill: white;
            }
        </style>
    </head>
    <body>
        <script type="text/javascript">
        // hard brackets [] indicate an array, and
        // curly brackets {} indicate an object.
            var dataset = [];
            var color = d3.scale.category10();
            var barPadding = 3;

            var w = 500;
            var h = 300;

            d3.json("/es/", function(
                error, json) {
                if (error) return console.warn(error);
                data_len = json.length
                // console.log(json[0]._source.authors)
                var i
                for (i=0; i<data_len; i++) {
                    dataset.push(json[i]._source.authors.length);
                      // { key: i, value: json.data[i].id} );
                }
                console.log(dataset);
                // dataset=[23, 23, 64, 70];
                makeBarChart();
            });

            function makeBarChart() {
                var svg = d3.select("body").append("svg");
                svg.attr("width", w)
                   .attr("height", h);
                svg.selectAll("rect")
                   .data(dataset)
                   .enter()
                   .append("rect")
                   .attr("x", function(d, i) {
                       return i * (w / dataset.length);
                       // bar width of 20 plus 1 for padding
                   })
                   .attr("y", function(d) {
                       return h - d * 40;
                       // height minus data value
                   })
                   .attr("width", w / dataset.length - barPadding)
                   .attr("height", function(d) {
                       return d * 40;
                   })
                   .attr("fill", function(d) {
                       return "rgb(0,200,"+ (d*10) +")";
                   });
                svg.selectAll("text")
                   .data(dataset)
                   .enter()
                   .append("text")
                   .text(function(d) {
                       return d;
                   })
                   .attr("x", function(d, i) {
                        return i * (w / dataset.length) + (w / dataset.length - barPadding) / 2;
                    })
                   .attr("y", function(d) {
                        return h - (d * 40) + 15;
                   })
                   .attr("font-family", "sans-serif")
                   .attr("font-size", "11px")
                   .attr("fill", "white")
                   .attr("text-anchor", "middle");
            }

        </script>
    </body>
</html>
